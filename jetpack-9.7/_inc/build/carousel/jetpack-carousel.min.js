/* Do not modify this file directly. It is compiled from other files. */
/* global jetpackCarouselStrings, DocumentTouch */
jQuery(document).ready(function(e){var t,a,i,o,r,s,n,l,c,d,u,p,m,h,f,g=e("body").css("overflow"),j=e("html").css("overflow"),w="",_=function(e){switch(e.which){case 38:e.preventDefault(),i.scrollTop(i.scrollTop()-100);break;case 40:e.preventDefault(),i.scrollTop(i.scrollTop()+100);break;case 39:e.preventDefault(),a.jp_carousel("next");break;case 37:case 8:e.preventDefault(),a.jp_carousel("previous");break;case 27:e.preventDefault(),i.jp_carousel("close")}},v=function(){if(u=110,window.innerWidth<=760){u=Math.round(window.innerWidth/760*110);var e="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;u<40&&e&&(u=0)}},x=function(){var e=window.matchMedia&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches;clearTimeout(n),n=setTimeout(function(){v(),a.jp_carousel("slides").jp_carousel("fitSlide",e),a.jp_carousel("updateSlidePositions",e),a.jp_carousel("fitMeta",e)},200)},b=function(){e("a img[data-attachment-id]").each(function(){var t=e(this).parent();if(!t.parent(".gallery-icon").length&&void 0!==e(t).attr("href")){var a=!1;e(t).attr("href").split("?")[0]===e(this).attr("data-orig-file").split("?")[0]&&1===Number(jetpackCarouselStrings.single_image_gallery_media_file)&&(a=!0),e(t).attr("href")===e(this).attr("data-permalink")&&(a=!0),a&&(e(t).addClass("single-image-gallery"),e(t).data("carousel-extra",{blog_id:Number(jetpackCarouselStrings.blog_id)}))}})},y={testForData:function(t){return!(!(t=e(t)).length||!t.data("carousel-extra"))},testIfOpened:function(){return!(void 0===a||void 0===a.opened||!a.opened)},openOrSelectSlide:function(t){e(this).jp_carousel("testIfOpened")?a.jp_carousel("selectSlideAtIndex",t):e(this).jp_carousel("open",{start_index:t})},open:function(n){var c={items_selector:".gallery-item [data-attachment-id], .tiled-gallery-item [data-attachment-id], img[data-attachment-id]",start_index:0},d=e(this).data("carousel-extra");if(d&&(function(){if(!t){i=e(".jp-carousel-wrap"),t=i.find(".jp-carousel-overlay"),a=i.find(".jp-carousel"),s=i.find(".jp-carousel-caption"),l=i.find(".jp-carousel-photo-info"),o=i.find(".jp-carousel-info"),h=i.find(".jp-carousel-comment-form-container"),p=i.find(".jp-carousel-image-meta"),m=i.find(".jp-carousel-titleanddesc");var n=i.find(".jp-carousel-next-button"),c=i.find(".jp-carousel-previous-button");v(),a.jp_carousel("fitMeta",!1),i.click(function(t){var r=e(t.target),s=r.parents("div.jp-carousel-wrap"),n=s.data("carousel-extra"),l=s.find("div.selected").data("attachment-id");if(n=n||[],r.is(a)||r.parents().add(r).is(i.find(".jp-carousel-close-hint")))window.matchMedia("(max-device-width: 760px)").matches?(r.parents().add(r).is(i.find(".jp-carousel-close-hint"))&&i.jp_carousel("close"),t.pageX<=70&&i.jp_carousel("previous"),e(window).width()-t.pageX<=70&&i.jp_carousel("next")):i.jp_carousel("close");else if(r.hasClass("jp-carousel-commentlink"))t.preventDefault(),t.stopPropagation(),e(window).unbind("keydown",_),i.animate({scrollTop:parseInt(o.position().top,10)},"fast"),e("#jp-carousel-comment-form-submit-and-info-wrapper").slideDown("fast"),e("#jp-carousel-comment-form-comment-field").focus();else if(r.hasClass("jp-carousel-comment-login")){var c=jetpackCarouselStrings.login_url+"%23jp-carousel-"+l;window.location.href=c}else if(r.parents("#jp-carousel-comment-form-container").length){var d=e("#jp-carousel-comment-form-comment-field").blur(function(){e(window).bind("keydown",_)}).focus(function(){e(window).unbind("keydown",_)}),u=e("#jp-carousel-comment-form-email-field").blur(function(){e(window).bind("keydown",_)}).focus(function(){e(window).unbind("keydown",_)}),p=e("#jp-carousel-comment-form-author-field").blur(function(){e(window).bind("keydown",_)}).focus(function(){e(window).unbind("keydown",_)}),m=e("#jp-carousel-comment-form-url-field").blur(function(){e(window).bind("keydown",_)}).focus(function(){e(window).unbind("keydown",_)});if(d&&d.attr("id")===r.attr("id"))e(window).unbind("keydown",_),e("#jp-carousel-comment-form-submit-and-info-wrapper").slideDown("fast");else if(r.is('input[type="submit"]')){t.preventDefault(),t.stopPropagation(),e("#jp-carousel-comment-form-spinner").show();var h={action:"post_attachment_comment",nonce:jetpackCarouselStrings.nonce,blog_id:n.blog_id,id:l,comment:d.val()};if(!h.comment.length)return void a.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-comment-field",error:jetpackCarouselStrings.no_comment_text});if(1!==Number(jetpackCarouselStrings.is_logged_in)&&(h.email=u.val(),h.author=p.val(),h.url=m.val(),1===Number(jetpackCarouselStrings.require_name_email))){if(!h.email.length||!h.email.match("@"))return void a.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-email-field",error:jetpackCarouselStrings.no_comment_email});if(!h.author.length)return void a.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-author-field",error:jetpackCarouselStrings.no_comment_author})}e.ajax({type:"POST",url:jetpackCarouselStrings.ajaxurl,data:h,dataType:"json",success:function(t){"approved"===t.comment_status?e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_approved+"</span>").slideDown("fast"):"unapproved"===t.comment_status?e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_unapproved+"</span>").slideDown("fast"):e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-error">'+jetpackCarouselStrings.comment_post_error+"</span>").slideDown("fast"),a.jp_carousel("clearCommentTextAreaValue"),a.jp_carousel("getComments",{attachment_id:l,offset:0,clear:!0}),e("#jp-carousel-comment-form-button-submit").val(jetpackCarouselStrings.post_comment),e("#jp-carousel-comment-form-spinner").hide()},error:function(){a.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-comment-field",error:jetpackCarouselStrings.comment_post_error})}})}}else r.parents(".jp-carousel-info").length||(window.matchMedia("(max-device-width: 760px)").matches?(t.pageX<=70&&i.jp_carousel("previous"),e(window).width()-t.pageX<=70&&i.jp_carousel("next")):i.jp_carousel("next"))}).bind("jp_carousel.afterOpen",function(){e(window).bind("keydown",_),e(window).bind("resize",x),a.opened=!0,x()}).bind("jp_carousel.beforeClose",function(){var t=e(window).scrollTop();e(window).unbind("keydown",_),e(window).unbind("resize",x),e(window).scrollTop(t),e(".jp-carousel-previous-button").hide(),e(".jp-carousel-next-button").hide(),e("html").css("height","")}).bind("jp_carousel.afterClose",function(){window.location.hash&&history.back&&history.back(),w="",a.opened=!1}).on("transitionend.jp-carousel ",".jp-carousel-slide",function(t){if("transform"===t.originalEvent.propertyName){var a=(Date.now()-r)/1e3/t.originalEvent.elapsedTime;i.off("transitionend.jp-carousel"),a>=2&&e(".jp-carousel-transitions").removeClass("jp-carousel-transitions")}}),i.touchwipe({wipeLeft:function(e){e.preventDefault(),a.jp_carousel("next")},wipeRight:function(e){e.preventDefault(),a.jp_carousel("previous")},preventDefaultEvents:!1}),n.add(c).click(function(e){e.preventDefault(),e.stopPropagation(),n.is(this)?a.jp_carousel("next"):a.jp_carousel("previous")})}}(),!a.jp_carousel("testIfOpened")))return g=e("body").css("overflow"),e("body").css("overflow","hidden"),j=e("html").css("overflow"),e("html").css("overflow","hidden"),f=e(window).scrollTop(),i.data("carousel-extra",d),this.each(function(){var t=e(this);n&&e.extend(c,n),-1===c.start_index&&(c.start_index=0),i.trigger("jp_carousel.beforeOpen").fadeIn("fast",function(){i.trigger("jp_carousel.afterOpen"),a.jp_carousel("initSlides",t.find(c.items_selector),c.start_index).jp_carousel("selectSlideAtIndex",c.start_index)}),a.html("")})},selectSlideAtIndex:function(e){var t=this.jp_carousel("slides"),i=t.eq(e);return 0===i.length&&(i=t.eq(0)),a.jp_carousel("selectSlide",i,!1),this},close:function(){return e("body").css("overflow",g),e("html").css("overflow",j),this.jp_carousel("clearCommentTextAreaValue"),i.trigger("jp_carousel.beforeClose").fadeOut("fast",function(){i.trigger("jp_carousel.afterClose"),e(window).scrollTop(f)})},next:function(){this.jp_carousel("previousOrNext","nextSlide")},previous:function(){this.jp_carousel("previousOrNext","prevSlide")},previousOrNext:function(e){if(!this.jp_carousel("hasMultipleImages"))return!1;var t=a.jp_carousel(e);t&&(i.animate({scrollTop:0},"fast"),this.jp_carousel("clearCommentTextAreaValue"),this.jp_carousel("selectSlide",t))},selectedSlide:function(){return this.find(".selected")},setSlidePosition:function(e){return r=Date.now(),this.css({"-webkit-transform":"translate3d("+e+"px,0,0)","-moz-transform":"translate3d("+e+"px,0,0)","-ms-transform":"translate("+e+"px,0)","-o-transform":"translate("+e+"px,0)",transform:"translate3d("+e+"px,0,0)"})},updateSlidePositions:function(e){var t=this.jp_carousel("selectedSlide"),i=a.width(),o=t.width(),r=a.jp_carousel("prevSlide"),s=a.jp_carousel("nextSlide"),n=r.prev(),l=s.next(),c=Math.floor(.5*(i-o));t.jp_carousel("setSlidePosition",c).show(),a.jp_carousel("fitInfo",e),1===(d.is(t.prevAll())?1:-1)?(l.is(r)||l.jp_carousel("setSlidePosition",i+s.width()).show(),n.is(s)||n.jp_carousel("setSlidePosition",-n.width()-o).show()):l.is(r)||l.jp_carousel("setSlidePosition",i+o).show(),r.jp_carousel("setSlidePosition",Math.floor(-r.width()+.75*u)).show(),s.jp_carousel("setSlidePosition",Math.ceil(i-.75*u)).show()},selectSlide:function(t,o){d=this.find(".selected").removeClass("selected");var r,n,l=a.jp_carousel("slides").css({position:"fixed"}),c=e(t).addClass("selected").css({position:"relative"}),u=c.data("attachment-id"),p=a.jp_carousel("prevSlide"),m=a.jp_carousel("nextSlide"),h=p.prev(),f=m.next();a.jp_carousel("loadFullImage",c),s.hide(),0===m.length&&l.length<=2?e(".jp-carousel-next-button").hide():e(".jp-carousel-next-button").show(),0===p.length&&l.length<=2?e(".jp-carousel-previous-button").hide():e(".jp-carousel-previous-button").show(),r=c.add(p).add(h).add(m).add(f).jp_carousel("loadSlide"),l.not(r).hide(),a.jp_carousel("updateSlidePositions",o),i.trigger("jp_carousel.selectSlide",[c]),a.jp_carousel("getTitleDesc",{title:c.data("title"),desc:c.data("desc")});var g=c.data("image-meta");a.jp_carousel("updateExif",g),a.jp_carousel("updateFullSizeLink",c),1==+jetpackCarouselStrings.display_comments&&(a.jp_carousel("testCommentsOpened",c.data("comments-opened")),a.jp_carousel("getComments",{attachment_id:u,offset:0,clear:!0}),e("#jp-carousel-comment-post-results").slideUp()),c.data("caption")?((n=e("<div />").text(c.data("caption")).html())===e("<div />").text(c.data("title")).html()&&e(".jp-carousel-titleanddesc-title").fadeOut("fast").empty(),n===e("<div />").text(c.data("desc")).html()&&e(".jp-carousel-titleanddesc-desc").fadeOut("fast").empty(),s.html(c.data("caption")).fadeIn("slow")):s.fadeOut("fast").empty(),jetpackCarouselStrings.stats&&((new Image).src=document.location.protocol+"//pixel.wp.com/g.gif?"+jetpackCarouselStrings.stats+"&post="+encodeURIComponent(u)+"&rand="+Math.random()),e(m).add(p).each(function(){a.jp_carousel("loadFullImage",e(this))}),window.location.hash=w="#jp-carousel-"+u},slides:function(){return this.find(".jp-carousel-slide")},slideDimensions:function(){return{width:e(window).width()-2*u,height:Math.floor(e(window).height()/100*85-60)}},loadSlide:function(){return this.each(function(){var t=e(this);t.find("img").one("load",function(){t.jp_carousel("fitSlide",!1)})})},bestFit:function(){var e,t,i=a.jp_carousel("slideDimensions"),o=this.jp_carousel("originalDimensions"),r=o.width/o.height,s=1,n=1;return o.width>i.width&&(s=i.width/o.width),o.height>i.height&&(n=i.height/o.height),s<n?(e=i.width,t=Math.floor(e/r)):n<s?(t=i.height,e=Math.floor(t*r)):(e=o.width,t=o.height),{width:e,height:t}},fitInfo:function(){var e=this.jp_carousel("selectedSlide").jp_carousel("bestFit");return l.css({left:Math.floor(.5*(o.width()-e.width)),width:Math.floor(e.width)}),this},fitMeta:function(e){var t={left:u+"px",right:u+"px"};e?o.animate(t):o.css(t)},fitSlide:function(){return this.each(function(){var t=e(this),i=t.jp_carousel("bestFit"),o=a.jp_carousel("slideDimensions");i.left=0,i.top=Math.floor(.5*(o.height-i.height))+40,t.css(i)})},texturize:function(t){return t=(t=(t=(t=""+t).replace(/'/g,"&#8217;").replace(/&#039;/g,"&#8217;").replace(/[\u2019]/g,"&#8217;")).replace(/"/g,"&#8221;").replace(/&#034;/g,"&#8221;").replace(/&quot;/g,"&#8221;").replace(/[\u201D]/g,"&#8221;")).replace(/([\w]+)=&#[\d]+;(.+?)&#[\d]+;/g,'$1="$2"'),e.trim(t)},initSlides:function(t,i){t.length<2?e(".jp-carousel-next-button, .jp-carousel-previous-button").hide():e(".jp-carousel-next-button, .jp-carousel-previous-button").show(),t.each(function(){var t,i=e(this),o=i.data("orig-size")||"",r=a.jp_carousel("slideDimensions"),s=o.split(","),n=i.data("medium-file")||"",l=i.data("large-file")||"";o={width:parseInt(s[0],10),height:parseInt(s[1],10)},t=i.data("orig-file"),t=a.jp_carousel("selectBestImageSize",{orig_file:t,orig_width:o.width,orig_height:o.height,max_width:r.width,max_height:r.height,medium_file:n,large_file:l}),e(this).data("gallery-src",t)}),0!==i&&(e("<img/>")[0].src=e(t[i]).data("gallery-src"));var o=t.first().closest(".tiled-gallery.type-rectangular").length>0;return t.each(function(t){var r=e(this),s=r.data("attachment-id")||0,n=r.data("comments-opened")||0,l=r.data("image-meta")||{},c=r.data("orig-size")||"",d={width:r[0].naturalWidth,height:r[0].naturalHeight},u=r.data("image-title")||"",p=r.data("image-description")||"",m=r.parents(".gallery-item").find(".gallery-caption").html()||"",h=r.data("gallery-src")||"",f=r.data("medium-file")||"",g=r.data("large-file")||"",j=r.data("orig-file")||"",w=r.parents("div.tiled-gallery-item").find("div.tiled-gallery-caption").html();if(w&&(m=w),s&&c.length){u=a.jp_carousel("texturize",u),p=a.jp_carousel("texturize",p),m=a.jp_carousel("texturize",m);var _=e("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7").css("width","100%").css("height","100%"),v=e('<div class="jp-carousel-slide" itemprop="associatedMedia" itemscope itemtype="https://schema.org/ImageObject"></div>').hide().css({left:t<i?-1e3:a.width()}).append(_).appendTo(a).data("src",h).data("title",u).data("desc",p).data("caption",m).data("attachment-id",s).data("permalink",r.parents("a").attr("href")).data("orig-size",c).data("comments-opened",n).data("image-meta",l).data("medium-file",f).data("large-file",g).data("orig-file",j).data("thumb-size",d);o&&v.data("preview-image",r.attr("src")).css({"background-image":'url("'+r.attr("src")+'")',"background-size":"100% 100%","background-position":"center center"}),v.jp_carousel("fitSlide",!1)}}),this},selectBestImageSize:function(e){if("object"!=typeof e&&(e={}),void 0===e.orig_file)return"";if(void 0===e.orig_width||void 0===e.max_width)return e.orig_file;if(void 0===e.medium_file||void 0===e.large_file)return e.orig_file;var t=document.createElement("a");t.href=e.large_file;var i=/^i[0-2].wp.com$/i.test(t.hostname),o=a.jp_carousel("getImageSizeParts",e.medium_file,e.orig_width,i),r=a.jp_carousel("getImageSizeParts",e.large_file,e.orig_width,i),s=parseInt(r[0],10),n=parseInt(r[1],10),l=parseInt(o[0],10),c=parseInt(o[1],10);if(e.orig_max_width=e.max_width,e.orig_max_height=e.max_height,void 0!==window.devicePixelRatio&&window.devicePixelRatio>1&&(e.max_width=e.max_width*window.devicePixelRatio,e.max_height=e.max_height*window.devicePixelRatio),s>=e.max_width||n>=e.max_height)return e.large_file;if(l>=e.max_width||c>=e.max_height)return e.medium_file;if(i){var d=e.large_file.lastIndexOf("?"),u=e.large_file;return-1!==d&&(u=e.large_file.substring(0,d),(e.orig_width>e.max_width||e.orig_height>e.max_height)&&(u+="?fit="+e.orig_max_width+"%2C"+e.orig_max_height)),u}return e.orig_file},getImageSizeParts:function(e,t,a){var i=a?e.replace(/.*=([\d]+%2C[\d]+).*$/,"$1"):e.replace(/.*-([\d]+x[\d]+)\..+$/,"$1"),o=i!==e?a?i.split("%2C"):i.split("x"):[t,0];return"9999"===o[0]&&(o[0]="0"),"9999"===o[1]&&(o[1]="0"),o},originalDimensions:function(){var t=e(this).data("orig-size").split(",");return{width:parseInt(t[0],10),height:parseInt(t[1],10)}},format:function(e){if("object"!=typeof e&&(e={}),e.text&&void 0!==e.text)return e.replacements&&void 0!==e.replacements?e.text.replace(/{(\d+)}/g,function(t,a){return void 0!==e.replacements[a]?e.replacements[a]:t}):e.text},shutterSpeed:function(e){return e>=1?Math.round(10*e)/10+"s":"1/"+Math.round(1/e)+"s"},parseTitleDesc:function(e){return!e.match(" ")&&e.match("_")?"":e},getTitleDesc:function(t){var i,o,r="",s="";(o=e("div.jp-carousel-titleanddesc","div.jp-carousel-wrap")).hide(),r=a.jp_carousel("parseTitleDesc",t.title)||"",i=a.jp_carousel("parseTitleDesc",t.desc)||"",(r.length||i.length)&&(e("<div />").html(r).text()===e("<div />").html(i).text()&&(r=""),s=r.length?'<div class="jp-carousel-titleanddesc-title">'+r+"</div>":"",s+=i.length?'<div class="jp-carousel-titleanddesc-desc">'+i+"</div>":"",o.html(s).fadeIn("slow")),e("div#jp-carousel-comment-form-container").css("margin-top","20px"),e("div#jp-carousel-comments-loading").css("margin-top","20px")},updateExif:function(t){if(!t||1!==Number(jetpackCarouselStrings.display_exif))return!1;var i=e("<ul class='jp-carousel-image-exif'></ul>");e.each(t,function(t,o){if(0!==parseFloat(o)&&o.length&&-1!==e.inArray(t,e.makeArray(jetpackCarouselStrings.meta_data))){switch(t){case"focal_length":o+="mm";break;case"shutter_speed":o=a.jp_carousel("shutterSpeed",o);break;case"aperture":o="f/"+o}i.append("<li><h5>"+jetpackCarouselStrings[t]+"</h5>"+o+"</li>")}}),e("div.jp-carousel-image-meta ul.jp-carousel-image-exif").replaceWith(i)},updateFullSizeLink:function(t){if(!t||!t.data)return!1;var i,o=t.data("orig-size").split(","),r=document.createElement("a");r.href=t.data("src").replace(/\?.+$/,""),i=null!==r.hostname.match(/^i[\d]{1}.wp.com$/i)?r.href:t.data("orig-file").replace(/\?.+$/,"");var s=e("<a>"+a.jp_carousel("format",{text:jetpackCarouselStrings.download_original,replacements:o})+"</a>").addClass("jp-carousel-image-download").attr("href",i).attr("target","_blank");e("div.jp-carousel-image-meta a.jp-carousel-image-download").replaceWith(s)},testCommentsOpened:function(t){1===parseInt(t,10)?(e(".jp-carousel-buttons").fadeIn("fast"),h.fadeIn("fast")):(e(".jp-carousel-buttons").fadeOut("fast"),h.fadeOut("fast"))},getComments:function(t){if(clearInterval(c),"object"==typeof t&&void 0!==t.attachment_id&&t.attachment_id){(!t.offset||void 0===t.offset||t.offset<1)&&(t.offset=0);var i=e(".jp-carousel-comments"),o=e("#jp-carousel-comments-loading").show();t.clear&&i.hide().empty(),e.ajax({type:"GET",url:jetpackCarouselStrings.ajaxurl,dataType:"json",data:{action:"get_attachment_comments",nonce:jetpackCarouselStrings.nonce,id:t.attachment_id,offset:t.offset},success:function(r){t.clear&&i.fadeOut("fast").empty(),e(r).each(function(){var o=e("<div></div>").addClass("jp-carousel-comment").attr("id","jp-carousel-comment-"+this.id).html('<div class="comment-gravatar">'+this.gravatar_markup+'</div><div class="comment-author">'+this.author_markup+'</div><div class="comment-date">'+this.date_gmt+'</div><div class="comment-content">'+this.content+"</div>");i.append(o),clearInterval(c),c=setInterval(function(){e(".jp-carousel-overlay").height()-150<e(".jp-carousel-wrap").scrollTop()+e(window).height()&&(a.jp_carousel("getComments",{attachment_id:t.attachment_id,offset:t.offset+10,clear:!1}),clearInterval(c))},300)});var s=e(".jp-carousel div.selected");if(s&&s.data&&s.data("attachment-id")!==t.attachment_id)return i.fadeOut("fast"),void i.empty();e(".jp-carousel-overlay").height(e(window).height()+m.height()+h.height()+(i.height()>0?i.height():p.height())+200),i.show(),o.hide()},error:function(){i.fadeIn("fast"),o.fadeOut("fast")}})}},postCommentError:function(t){"object"!=typeof t&&(t={}),t.field&&void 0!==t.field&&t.error&&void 0!==t.error&&(e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-error">'+t.error+"</span>").slideDown("fast"),e("#jp-carousel-comment-form-spinner").hide())},setCommentIframeSrc:function(t){var a=e("#jp-carousel-comment-iframe");a&&a.length&&(a.attr("src",a.attr("src").replace(/(postid=)\d+/,"$1"+t)),a.attr("src",a.attr("src").replace(/(%23.+)?$/,"%23jp-carousel-"+t)))},clearCommentTextAreaValue:function(){var t=e("#jp-carousel-comment-form-comment-field");t&&t.val("")},nextSlide:function(){var e=this.jp_carousel("slides"),t=this.jp_carousel("selectedSlide");return 0===t.length||e.length>2&&t.is(e.last())?e.first():t.next()},prevSlide:function(){var e=this.jp_carousel("slides"),t=this.jp_carousel("selectedSlide");return 0===t.length||e.length>2&&t.is(e.first())?e.last():t.prev()},loadFullImage:function(t){var a=t.find("img:first");a.data("loaded")||(a.on("load.jetpack",function(){a.off("load.jetpack"),e(this).closest(".jp-carousel-slide").css("background-image","")}),!t.data("preview-image")||t.data("thumb-size")&&t.width()>t.data("thumb-size").width?a.attr("src",a.closest(".jp-carousel-slide").data("src")).attr("itemprop","image"):a.attr("src",t.data("preview-image")).attr("itemprop","image"),a.data("loaded",1))},hasMultipleImages:function(){return a.jp_carousel("slides").length>1}};e.fn.jp_carousel=function(t){return y[t]?y[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.jp_carousel"):y.open.apply(this,arguments)},e(document.body).on("click.jp-carousel","div.gallery, div.tiled-gallery, ul.wp-block-gallery, ul.blocks-gallery-grid, figure.blocks-gallery-grid, div.wp-block-jetpack-tiled-gallery, a.single-image-gallery",function(t){if(e(this).jp_carousel("testForData",t.currentTarget)){if(e(t.target).parents().eq(1).hasClass("wp-block-image")){var a=e(t.target).parent().attr("href");if(a.split("?")[0]!==e(t.target).attr("data-orig-file").split("?")[0]&&a!==e(t.target).attr("data-permalink"))return}e(t.target).parent().hasClass("gallery-caption")||e(t.target).parent().is("figcaption")||(e("html").css("height","auto"),t.preventDefault(),t.stopPropagation(),e(this).jp_carousel("open",{start_index:e(this).find(".gallery-item, .tiled-gallery-item, .blocks-gallery-item, .tiled-gallery__item, .wp-block-image").index(e(t.target).parents(".gallery-item, .tiled-gallery-item, .blocks-gallery-item, .tiled-gallery__item, .wp-block-image"))}))}}),1===Number(jetpackCarouselStrings.single_image_gallery)&&(b(),e(document.body).on("post-load",function(){b()})),e(window).on("hashchange.jp-carousel",function(){var t,o,r,s=/jp-carousel-(\d+)/;window.location.hash&&s.test(window.location.hash)?window.location.hash===w&&a.opened||(window.location.hash&&a&&!a.opened&&history.back?history.back():(w=window.location.hash,t=window.location.hash.match(s),o=parseInt(t[1],10),e("div.gallery, div.tiled-gallery, a.single-image-gallery, ul.wp-block-gallery, div.wp-block-jetpack-tiled-gallery").each(function(t,a){if(e(a).find("img").each(function(t,i){if(e(i).data("attachment-id")===parseInt(o,10))return r={index:t,gallery:a},!1}),r)return e(r.gallery).jp_carousel("openOrSelectSlide",r.index),!1}))):a&&a.opened&&i.jp_carousel("close")}),window.location.hash&&e(window).trigger("hashchange")}),function(e){e.fn.touchwipe=function(t){var a,i={threshold:150,restraint:100,allowedTime:300,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};return t&&e.extend(i,t),this.each(function(){var e,t,o=!1;function r(){this.removeEventListener("touchmove",s),e=null,o=!1}function s(s){if(i.preventDefaultEvents&&s.preventDefault(),o){var n=s.touches[0].pageX,l=s.touches[0].pageY,c=e-n,d=t-l;(new Date).getTime()-a<=i.allowedTime&&(Math.abs(c)>=i.threshold&&Math.abs(d)<=i.restraint?(r(),c>0?i.wipeLeft(s):i.wipeRight(s)):Math.abs(d)>=i.threshold&&Math.abs(c)<=i.restraint&&(r(),d>0?i.wipeDown(s):i.wipeUp(s)))}}"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",function(i){1===i.touches.length&&(a=(new Date).getTime(),e=i.touches[0].pageX,t=i.touches[0].pageY,o=!0,this.addEventListener("touchmove",s,!1))},!1)}),this}}(jQuery);