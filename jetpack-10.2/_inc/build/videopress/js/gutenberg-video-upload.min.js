/* Do not modify this file directly. It is compiled from other files. */
/* globals wp, lodash */
wp.apiFetch.use(function(e,t){var o=e.path,n=e.method,a=e.body,r=a?a.get("file"):null;if(!o||-1===o.indexOf("/wp/v2/media"))return t(e);if(!n||"post"!==n.toLowerCase())return t(e);if(!r||0!==r.type.indexOf("video/"))return t(e);wp.media.ajax("videopress-get-upload-token",{async:!1,data:{filename:r.name}}).done(function(t){var o=e.headers||{};o.Authorization='X_UPLOAD_TOKEN token="'+t.upload_token+'" blog_id="'+t.upload_blog_id+'"',e.headers=o,delete e.path,e.url=t.upload_action_url,e.credentials="omit",a.set("media[]",r),a.delete("file"),e.body=a});var i=t(e);return new Promise(function(e,t){i.then(function(e){return e instanceof Response&&e.ok?e.json():e}).then(function(t){var o=lodash.get(t,"media[0]"),n=lodash.get(o,"ID"),a=wp.apiFetch({path:"/wp/v2/media/"+n});e(a)}).catch(function(e){"errors"in e&&"object"==typeof e.errors&&e.errors.length>0&&(e=e.errors.shift()),t(e)})})});